---
title: "we"
author: "Karthik Edupuganti"
date: "2023-10-10"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r, message = FALSE}
library(httr)
library(jsonlite)
library(tidyverse)
```


```{r}
fruits_full <- function() {
    
dataframe <- fromJSON("https://www.fruityvice.com/api/fruit/all")
  
#Extracting variables from nested dataframe variable "Nutritions"
nutrition_variables <- dataframe$nutritions

#Extract and convert the variables from the nested dataframe
dataframe$calories <- nutrition_variables$calories
dataframe$fat <- nutrition_variables$fat
dataframe$sugar <- nutrition_variables$sugar
dataframe$carbohydrates <- nutrition_variables$carbohydrates
dataframe$protein <- nutrition_variables$protein


#Remove the original nested variable
dataframe$nutritions <- NULL


return(as_tibble(dataframe))
}


```


```{r}
fruits_by_family <- function(family_name = "Rosaceae") {
    
url_base <- "https://www.fruityvice.com/api/fruit/family/"

dataframe <- fromJSON(paste0(url_base, family_name))


#Extracting variables from nested dataframe variable "Nutritions"
nutrition_variables <- dataframe$nutritions

# Extract and convert the variables from the nested dataframe
dataframe$calories <- nutrition_variables$calories
dataframe$fat <- nutrition_variables$fat
dataframe$sugar <- nutrition_variables$sugar
dataframe$carbohydrates <- nutrition_variables$carbohydrates
dataframe$protein <- nutrition_variables$protein


# Remove the original nested variable
dataframe$nutritions <- NULL


return(as_tibble(dataframe))
}
```


```{r}
fruits_by_order <- function(order_name = "Rosales") {
    
url_base <- "https://www.fruityvice.com/api/fruit/order/"

dataframe <- fromJSON(paste0(url_base, order_name))


#Extracting variables from nested dataframe variable "Nutritions"
nutrition_variables <- dataframe$nutritions

# Extract and convert the variables from the nested dataframe
dataframe$calories <- nutrition_variables$calories
dataframe$fat <- nutrition_variables$fat
dataframe$sugar <- nutrition_variables$sugar
dataframe$carbohydrates <- nutrition_variables$carbohydrates
dataframe$protein <- nutrition_variables$protein


# Remove the original nested variable
dataframe$nutritions <- NULL


return(as_tibble(dataframe))
}


```


```{r}
fruits_by_nutrition_value <- function(nutrition_name = "calories", min = 0 , max = 50) {
    
url_base <- "https://www.fruityvice.com/api/fruit/"

dataframe <- fromJSON(paste0(url_base,nutrition_name, "?min=", min, "&max=", max))


#Extracting variables from nested dataframe variable "Nutritions"
nutrition_variables <- dataframe$nutritions

# Extract and convert the variables from the nested dataframe
dataframe$calories <- nutrition_variables$calories
dataframe$fat <- nutrition_variables$fat
dataframe$sugar <- nutrition_variables$sugar
dataframe$carbohydrates <- nutrition_variables$carbohydrates
dataframe$protein <- nutrition_variables$protein


# Remove the original nested variable
dataframe$nutritions <- NULL


return(as_tibble(dataframe))
}

```


Now that we have the different endpoints to call the data from the API. Lets do some data exploration. Lets take a look at the overall data on fruits by calling the fruits_function() and storing the dataframe into an object called fruit_data_full.
```{r}
fruit_data_full <- fruits_full()
fruit_data_full
```

As you can see there are not too many observations, only 45, but we will still do some exploratory analysis. The nutrition values variables are calories, fat, sugar, carbohydrates, and protein. These variables are all measured in grams where values are per 100g of the fruit. Each observation is a different fruit.

The family, order, genus are taxonomic variables which are used in classification of different organisms. There is a taxonomic hierarchy where it is order --> family --> genus, in which order is the higher taxonomic level. 


I created a contingency table to look at the frequency of each order in full dataset.
```{r}
table(fruit_data_full$order)
```
Rosales has the most amount which is 15 fruits, followed by Sapindales which is 7 fruits. The other orders have low frequency around 1-2.


I created a contingency table to look at the frequency of each family in full dataset.
```{r}
table(fruit_data_full$family)
```
Rosaceae has the highest amount which is 11 fruits, followed by Rutaceae which is 5 fruits. The other families have low frequency around 1-2.


I created a contingency table to look at the frequency of each genus in full dataset.
```{r}
table(fruit_data_full$genus)
```
Citrus has the highest amount which is 5 fruits, followed by Prunus which is 4 fruits. The other families have low frequency around 1-2.


Fruits are considered a healthy part of a normal diet and are encouraged to be eaten by doctors, dietitians, and nutrition experts. Fruits also contain a lot of naturally occurring sugar as well. I want to see a histogram of sugar values for all the fruits in the data.
```{r}
ggplot(fruit_data_full, aes(x = sugar)) + geom_histogram(binwidth = 0.5, fill = "skyblue") +
  labs(title = "Histogram of Sugar Values for All Fruits", x = "Sugar Values per 100g", Y = "Frequency")
```
There seems to be relatively normal distribution to sugar amount for all the different types of fruits.


Calories are an important part of the 
```{r}
ggplot(fruit_data_full, aes(x = ))
```

